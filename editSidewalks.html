<html>
<head>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css">
	<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
	<script src="sidewalks.js"></script>
	
	<script>
		var map;
		var mapView;
		var satView;
		var showSat;
		
		var blueColor = ['aqua', 'blue'];
		var redColor = 'red';
		
		function initMap()
		{
			map = L.map('map', {
				center: [35.9738346, -78.8982177],
				zoom: 16,
				minZoom: 15,
				zoomControl: false
			});
		
			map.removeControl(map.attributionControl);
		
			/*
			mapView = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA', {
				maxZoom: 20,
				attribution: 'Imagery © <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',
				id: 'mapbox.streets',
			});
			*/
			
			mapView = L.tileLayer('https://maps.heigit.org/openmapsurfer/tiles/roads/webmercator/{z}/{x}/{y}.png', {
				maxZoom: 19,
				attribution: 'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			});

			satView = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
				maxZoom: 20,
				attribution: 'Imagery © <a href="https://www.mapbox.com/" target="_blank">Mapbox</a>',
				id: 'mapbox.satellite'
			});
		
			map.addLayer(mapView);
			
			showSat = true;
			
			showEdges();
		}
		
		function showEdges()
		{
			for(var i = 0; i < edges.length; i++)
			{
				var sidewalk1 = sidewalks[edges[i][0]];
				var sidewalk2 = sidewalks[edges[i][1]];
			
				var newline;
				
				var lineColor = (edges[i][2]) ? blueColor[0] : redColor;
				
				newline = L.polyline([[sidewalk1[0], sidewalk1[1]], [sidewalk2[0], sidewalk2[1]]], {color: lineColor, interactive: true, weight: 4});
				
				newline.on('click', function() {
					var thisIndex = Number(this);
					
					console.log(thisIndex);
				}.bind(i));
				
				newline.addTo(map);
			}
		}
		
		function swapTiles()
		{
			if(showSat)
			{
				map.removeLayer(mapView);
				map.addLayer(satView);
			}
			else
			{
				map.removeLayer(satView);
				map.addLayer(mapView);
			}
			
			showSat = !showSat;
		}
	</script>
	
	<style>
		body {
			margin: 0;
		}
		#map {
			margin: 8px;
			height: 80%;
			width: 99%;
		}
		#footer {
			height: 18%;
			width: 100%;
			display: flex;
		}
		.footerDiv {
			width: 25%;
		}
	</style>
	
</head>
<body onload="initMap();">
	<div id="map">
	</div>
	<div id="footer">
		<div class="footerDiv" id="div1">
			<p>Add/Edit Sidewalk</p>
		</div>
		<div class="footerDiv" id="div2">
			<p>Add/Edit Edge</p>			
		</div>
		<div class="footerDiv" id="div3">
			<p>Add/Edit Connection</p>
		</div>
		<div class="footerDiv" id="div4">
			<p>Controls</p>
			<button onclick="swapTiles();">Swap Tiles</button>
		</div>
		
	</div>
</body>
</html>